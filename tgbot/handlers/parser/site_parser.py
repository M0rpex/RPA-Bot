import requests
import json
import os

headers = {
    "user-agent": 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36'
}


cookie = {
    'Cookie': 'Dynamics365PortalAnalytics=1KGTF67KF5wa7eUoDtz9zxI20_T12TA0irAk7y5CHSjjz82O3O-mDoAia9Qt6L6I0iu5verIdOfJRl1oCZLwJpyF_SabeBv5dAtj4Sj_zy8FO14qBmoKartQBs3kR6j4xhK40RRWYK8kHSrCE9lCwQ2; ai_user=OJiCdkZxdm3ew+wH+aLRnb|2023-08-29T23:29:48.561Z; ARRAffinity=f3ed5018e9c50e027739a3ff83f3a4faca76a68b4a1e0741a72c3ab10bac3b2c; ARRAffinitySameSite=f3ed5018e9c50e027739a3ff83f3a4faca76a68b4a1e0741a72c3ab10bac3b2c; ASP.NET_SessionId=spqmp43ogslqp3ps2fpdwyam; timezoneoffset=-180; isDSTSupport=false; isDSTObserved=false; ContextLanguageCode=en-US; timeZoneCode=150; .AspNet.ApplicationCookie=Ho4Zc4E4n7Tp6le2opZCmipKmfTXmdHrqgeXs7GspeZi3SceDiSt87vLxHWPE-s-SySKg6b5isiymlIkWSy9RtrEzw0jtCRzFPmBbnc29Y8lcafp2KvLHN1M37VT23d_j7ttmoSKbfSWhxmIGoew4AUXeoNDNXN5Vfd_ezmFcpiAurxj72fFLOfYQsphwlManrFdc9N7Ef-N5gi4CIiBMY-BKNftbF8QdO-tRwxD7fGsJDSmBRXb_q2ibaJdTI-q45dvFuusNG3ANw4BuA_uz7D0nlMiMDGfuyKMSPQDlXUfwwuNqGMCCQ14o5rXckajShNpYWyOXl47WmmNZBn5qNYJFmlZg_EARKWmbAc5xLkLvQPixy3VvI86Vd-G7AUpNPcHYOSy_ahkIDcOqML-V-PewMbTMl_Tl-ADT7oYlzZmBTjF8KuTAVnQY7AG9X884bomPWF1jMh5a6jl9WWcURJHut9fsvnw8g7uhOptXuDAU8EvIwIFTM81UhZbhyMxfRl4H85Lc-F136sYD5TJm4kiuQUWi-mnzp6KqmE6vudtcRPUVEUARax1iGLgIsRnYR4lg5vy6zmgLKp0GEikoDwIwjjbZKbxZ0Kr0e5zD2oVd7Bs4eDaUcBLZJ3I3b8gXh-0stQ8z7T56VQdGypOXQWn2zBpb74gyPALZ_bkuCK-oQBRpL_XtqG2lpK01zN_M3C4lMAxh7fIna5M6R9RXYdXBihbyH3iBoQAEg9Y3bEtlaAbb8EJKjWU9YZOGocg6aoMVEkrJHRg7M0cSIrQogV101JhM43RJvIaVGVl8uk1tdf5u55NdMaLxDizExV7kVjfvZoSCCTYlAbrJZBvLuD9NOsdzGfw-xVcdOenNgz-Tjkc-8YYEUjV4lESo_Qc2d_c7VP5OCcmR-0DRMdShQyErF6sMcNp_2SbGMUbVUEeo8BPZnQywgUrqO1I1grbbBVRDlRjgjzu2A_gyCmpq3oPXu3FeV4ZCyEfVQahkrd5V1BxUF6JGtgpW_cp2r2FklY2zN3MeLnIPHT7FeDJ9mGgAisLsv0CyJo7Ihh1PAD7K1pwR-fcCxJ905UyN3WZ5kEja_k945dItEaSNcgiKHYzbGgaGiAdjdjvKWzr_CJN98Xgo53PTwAjsdY1MLQU3N4muihvdUBr3OPShi1oOzgbtkLsYs7hEYi1IfuRyrMtM0PBUuIJoZAGfcUZC8s7izWjRCOf_gAJFAS3s-Dt4JiwRY0BxAo7jTIiJXy6cwIR40L8raf3_PxT_8tW4P9KzpM6KHj57di0FF7byTtSg3DkMdc76qXkRga0773_KWFxPScjvh5C0n_30zO1SKIUySadztHIU2mhO3Q9nck4scMyyUY6U3TsDsa1YB6FsDICuJxqM1vgsIjtt8YNISp3XVlTm4myU7tD6rA7adqGATcpePxRL7bxoYPn5NQE1uagK_DAW_oOBNv1RrZrdgsn5kg7_ZrI0m5JokFUQr1zUVZgdOfNajfv5WBnEJaUSJqrGDWRoahdFRIBsuw27xK8ydPgl28nlM3m-qJHMpGUfjxF9Jv9cQS8O1jfHPV1RMY90sl2-590fhnVGIPqgILySONPhh8NNQeYEFHKqeggjYylJxtYWJdhPJx4tL0AQjPlHeOhvx6Ag2kpKLDN2Px5pk9IcWqu3w-dCLHGegLuqQSkA4hVr80WdsFIZ5MmMHub2e37pNXwx0xsrau7k0fJL-JgaGetP5_zCvEA8l3fWE0qKzWyMC7pmAmaiFMLfkGhJ-E3T50Sb1-6zO0qEBrWfulVvVTeMA_khkdAUzEb9SMxBLYRu5fZv5t0p3zUSW4pWpilNRZSPIkr2EnAyK1bVrImaSe414VtOcUUTAIle5cQNGqPuOcwy8-gIFRM6IrtP55H7zz3eVokQR2TudIjC5ZvR_3tOXtNdBP91-b8F9GIb6miExZLLcBgH7ntY32cwYGzBdcP1BL8_AvEGepTDTGYNKwXHalEf36IkjKuMjJIiaPhhT7skrP_GbdE9z_QxznhJcysFrOv1m1xKsS3PhCKFvTvtWyZon8_XcuVXkohP0g3UY7W3pFCySYfzJu1uSY27Fy0d4zfKbLfRD10ytakWyGZggKNr8ZM5Yu4zqBbebDQ5dvIgmkywQvT0X3nHtP2fudb5xRAZKNSVd4SP2lifs2OONT4nlfvt7q30SYhzG10ZiEBm61ThdXCJfXr4_eN4aDkKpQ1ow-sH42qx5f-_notK5NCY9egRGi2thphGQ7ENdBciuEH1K4U9jpFurxFzBwNI6jHF7JGYVanr7Nzjny6PGVNIolDZPV1O24AKS8yPE1qoxULfTDIanuCex_wT7D07Qdt9cXJsQS15YtQhor9B0yb7Mqc_uf84yv3_jeDTHbbifJ9uKC1hARhqiXi79avonI-g1VFkz31rAQwZxYG3zM-e5UENML0G71QeYA8RjQJgxX6ZLDNSMiP5yAEAoKRgV4cBMLV_K5CdOqPi8zFaeomxXBAN6LtiQ-Fo4HDxurT-bU5A5XnRudHHOIFJs6dRXRo4aHWyT7umbP3_RoBOlGxF53u34msGldWLvhXOqE85q_ge0yr-LgahKmCiofILxAne6Yl0tKgi3KVO_2bz-Lvp6dziqkGHLceT-VuYzhYkaSTyNdLJEDe1eymEXHtSLAnhE4vDOMlGCsq2SIfy6A3sdhFwUGvvDuTqxeLRsM2SK3_PcJUtc8f1juDJv08uCUYFMKJuMyCjTdJf-JNE4vW99OtTE-wVlbQTs0l-vHy1QupCPugyk6fCQQ-kTXQMvex65XUrRx4zWQhVbk15hRW5niCHOCHOQ_ACwUm5oJ3tTDaWyaqdnDK_D2GvCleU0Lhl_xM3vGP5Xpcpe12dCI1bQLjJAzFANkUKznVXLZJ4MrD4-6PBQQpWBLw2EW9kX-sAq56K_UsSQjes7e0_IG2EgLENco6TKWbV7LoE8d-CyzZZ1Y3aGUp2ID7mSdegaUKy9GHoGcPFwbaaoiPFcHgVMjFk4PBeZupab8jzvxsyaHJWW_81vDAfD9pNNkLAa6D0CTxZ4XCEIJbMJIgalSakAOG0ZKuVejZh_0HJToC36p49zwbvpsRGrVtH0KgHh2reBFQnlHcv0hf33LiryEbART5zHraOt4qqxD_bua9FhI-WfnflXvNjAx8f3CFO66xpTD_PVx9hdxkhj14qT41dLxXjkoFGg2h14B7HcKgHJp8itQECQg7fjDihwmep0JKbG-YBfI6EiYS8C8039mpezmAWIJpHG1KGdZ1HKEbUycG0SUBEDykTNq7ickXqBfW66oqtSJEWQlpd4orAvu2JtvWPOotG-MuUk17u0QDgMWlkax8SwO30qdV1BEk4a8ssNkv3e_HWzwIxoM6WStscFeBpjTHll1lB3MThgz5qer25WgRCqgM5GPTwiX33p8TKQ2fHCnnfApfD8cRNZJgE6fuN1u8ow8oPUeN4I2CGOjsqwaF7nu9CknxdpBuOo1L3i7hNKcAUOXwE_gwcfk_AhmVZRVZmz35PDYdCaLI4gxZWc4OZHMRIbq0T4gtB57tRzievrrDwS8UJ8kcrXYQ_9wnl2qo56XkWSLoBJvhXjzbHyyZpe1kigmCfbIfDVgGIwEgla_43msn-V-tbYwoZttl08apao9ucKa91mbn0bLeDN3ui0GmLfb89SadfRqm92_C9WCy4j8Er7VOG4nAJ8YZ9AC2I_aHe4BetoisJaZlGvIFm1kr86Nc0mp-Hk9dOZGRl8GC6ov817BORRI86iTQSlj-Hu77cU-WwFmuBtbS7eJVH_bnSi9x_fRuRVhtBEN3jrl8UI2yrr0w7LKCRED7yW3HPA; ai_session=wshaHIF61zTD1K31d97if3|1694699633978|1694699676081'
}



def get_free_dates(city, city_name):
    url = 'https://www.usvisascheduling.com/en-US/custom-actions/?route=/api/v1/schedule-group/get-family-ofc-schedule-days&cacheString=1694637530696'

    data = {
        "parameters": f'{{"primaryId":"b70b2f72-1e31-ee11-a81c-001dd80a6bbd","applications":["b70b2f72-1e31-ee11-a81c-001dd80a6bbd"],"scheduleDayId":"","scheduleEntryId":"","postId":"{city}"}}'
    }

    response = requests.post(url=url, data=data, headers=headers, cookies=cookie).text
    print(response)

    response_data = response

    # Сохраните данные в JSON-файле
    file_path = f"list/{city_name}_dict.json"
    with open(file_path, "w") as json_file:
        json.dump(json.loads(response_data), json_file, indent=4, ensure_ascii=False)



def chennai_get_available_hours(city, cityid):

    url = 'https://www.usvisascheduling.com/en-US/custom-actions/?route=/api/v1/schedule-group/get-family-ofc-schedule-entries&cacheString=1694616814398'

    data = {
        "parameters": f'{{"primaryId":"b70b2f72-1e31-ee11-a81c-001dd80a6bbd","applications":["b70b2f72-1e31-ee11-a81c-001dd80a6bbd"],"scheduleDayId":"{cityid}","scheduleEntryId":"","postId":"{city}"}}'
    }

    response = requests.post(url=url, data=data, headers=headers, cookies=cookie).text
    print(response)
